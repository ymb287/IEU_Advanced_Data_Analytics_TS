---
title: "Advanced Data Analytics"
author:
  - Loukas Gonzalez
  - Simon Alvarez Bliffeld
  - Simon Gonzalez
  - Yannik Biebert
date: "2023-11-28"
output:      
  rmarkdown::html_document:
    theme: cosmo
    highlight: tango
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
---

```{r setup, include=FALSE}
# Set up: do not change!!!
knitr::opts_chunk$set(echo = TRUE)
```

<br>

------------------------------------------------------------------------

<br>

# Part 1: Load packages, prepare the data

------------------------------------------------------------------------

## 1.1 Importing and inspecting the data set

```{r Import data, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
# import packages
library(pacman)
p_load(
  readxl, tseries, tidyverse, dplyr, tidyr, forecast, fpp2, stats, quantmod
)

# import data set xlxs
data <- read_excel("Datasets.xlsx")

# Display the data
print(data)
```

## 1.2 Prepare the data


```{r transform data, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
# Split the data into two dataframes based on the country
data_italy <- subset(data, Country %in% c("Italy"))
data_usa <- subset(data, Country %in% c("USA"))

# Function for data transformation
transform_data <- function(df) {
  # Extract columns from the dataframe
  gdp <- df$'GDP, billion currency units'
  housing_index <- df$'House price index'
  cpi <- df$'Consumer Price Index (CPI)'
  unemployment <- df$'Unemployment rate, percent'
  stocks <- df$'Stock market index'

  # Drop missing values
  gdp <- na.omit(gdp)
  housing_index <- na.omit(housing_index)

  # Change to time series
  gdp <- ts(gdp, start = c(2000, 1), frequency = 4)
  housing_index <- ts(housing_index, start = c(2000, 1), frequency = 4)
  cpi <- ts(cpi, start = c(2000, 1), frequency = 12)
  unemployment <- ts(unemployment, start = c(2000, 1), frequency = 12)
  stocks <- ts(stocks, start = c(2000, 1), frequency = 12)

  # Return the time series as separate variables
  return(list(gdp = gdp, housing_index = housing_index, cpi = cpi, unemployment = unemployment, stocks = stocks))
}

# Apply the transformation function
transformed_italy  <- transform_data(data_italy)
transformed_usa <- transform_data(data_usa)

```

## 1.3 Train test split

```{r train test split, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
# Function for train test split
train_test_split <- function(data_list, train_percentage = 0.8) {
  split_data <- list()
  
  # Loop through the variables in the list
  for (variable in names(data_list)) {
    ts_data <- data_list[[variable]]
    data_length <- length(ts_data)
    
    # Calculate the train size
    train_size <- round(train_percentage * data_length)
    
    # Split the data
    train_data <- ts_data[1:train_size]
    test_data <- ts_data[(train_size + 1):data_length]
    
    # Add the data to the list
    split_data[[paste0(variable, "_train")]] <- train_data
    split_data[[paste0(variable, "_test")]] <- test_data
  }

  return(split_data)
}

# Apply the train test split function
split_italy <- train_test_split(transformed_italy)
split_usa <- train_test_split(transformed_usa)

```



```{r extract data, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

# Extract the different variables



```


<br>

------------------------------------------------------------------------

<br>

# Part 2: Model Itally


------------------------------------------------------------------------

<br>

## 2 GDP

```{r modelling italy gdp, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}


# Extract the different variables



```

The effect of higher expenditures in Texas can be computed like this:

<center>*Percent votes for A* = 0.023855 $*$ *Campaign spending from A*</center>

<br> Inserting 10 for *Campaign spending from A*, gives us:

<center>*Percent votes for A* = 0.023855 $*$ 10 $\approx$ 0.24</center>

<br> The improvement is approximately the same, although limited by little underlying data.
